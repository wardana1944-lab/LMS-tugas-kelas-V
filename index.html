<!doctype html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RUANG BELAJAR - SDN PENGKOL</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    /* --- TAMPILAN DEPAN ASLI PAK ADIT --- */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
    body { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); min-height: 100vh; padding: 15px; color: #f8fafc; }
    .container { max-width: 1000px; margin: 0 auto; position: relative; }
    
    .header-main { text-align: center; margin-bottom: 25px; padding-top: 10px; }
    .header-main h1 { font-size: 1.8rem; color: #38bdf8; letter-spacing: 2px; margin-bottom: 20px; text-shadow: 0 0 15px rgba(56,189,248,0.5); }

    .identity-row { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; width: 100%; }
    .identitas-box, .guru-profile-box { 
        flex: 1; background: rgba(255,255,255,0.05); padding: 12px; border-radius: 15px; 
        border: 1px solid rgba(56,189,248,0.2); display: flex; align-items: center; gap: 12px; text-align: left; 
    }
    .identitas-box { border-style: dashed; }
    .guru-profile-box { background: rgba(56,189,248,0.1); }

    .img-identitas { width: 45px; height: 45px; object-fit: contain; }
    .foto-guru { width: 45px; height: 45px; border-radius: 50%; border: 2px solid #38bdf8; object-fit: cover; }
    .text-utama { font-weight: bold; color: #38bdf8; font-size: 0.75rem !important; }
    .sub-p { font-size: 0.7rem; line-height: 1.3; }

    .btn-guru-menu { 
        background: rgba(56,189,248,0.2); border: 1px solid #38bdf8; color: #38bdf8; 
        padding: 3px 8px; font-size: 0.6rem; cursor: pointer; border-radius: 5px; margin-top: 4px; font-weight: 600; 
    }

    .cards-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 12px; }
    .student-card { 
        background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); 
        border-radius: 15px; padding: 20px 10px 12px 10px; text-align: center; cursor: pointer; transition: 0.3s; position: relative; overflow: hidden; 
    }
    .status-badge { position: absolute; top: 0; right: 0; padding: 3px 7px; font-size: 0.55rem; font-weight: bold; border-bottom-left-radius: 10px; text-transform: uppercase; }
    .status-belum { background: #ef4444; color: white; }
    .status-sudah { background: #10b981; color: white; }
    .student-icon { width: 50px; height: 50px; background: #1e293b; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 10px; font-size: 1.8rem; border: 2px solid #38bdf8; }

    /* --- DASHBOARD GURU --- */
    #halamanGuru { display: none; background: #ffffff; color: #1e293b; border-radius: 20px; padding: 20px; margin-top: 10px; }
    .soal-card { background: #f1f5f9; padding: 15px; border-radius: 12px; margin-bottom: 15px; border-left: 5px solid #38bdf8; }
    input, textarea, select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 10px; }
    .btn { padding: 12px; border-radius: 10px; border: none; cursor: pointer; font-weight: bold; width: 100%; margin-top: 5px; }
    .btn-primary { background: #38bdf8; color: white; }
    .btn-add { background: #10b981; color: white; margin-bottom: 10px; }
    .btn-danger { background: #ef4444; color: white; }

    /* --- AREA KERJA SISWA & HASIL --- */
    #areaKerjaSiswa { display: none; background: white; color: #1e293b; border-radius: 20px; padding: 20px; }
    #sertifikat { display: none; background: white; color: #1e293b; padding: 30px; border-radius: 15px; border: 8px solid #38bdf8; text-align: center; }

    .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 100; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
    .modal { background: #1e293b; padding: 25px; border-radius: 20px; width: 90%; max-width: 400px; }
  </style>
</head>
<body>

<div class="container">
  <div id="halamanDepan">
    <div class="header-main">
      <h1>RUANG BELAJAR</h1>
      <div class="identity-row">
          <div class="identitas-box">
              <img src="logo-putih.png" class="img-identitas">
              <div><p class="text-utama">SDN Pengkol</p><p class="sub-p">Kelas 5 | 2025/2026</p></div>
          </div>
          <div class="guru-profile-box">
              <img src="foto-guru.webp" class="foto-guru">
              <div class="guru-info">
                  <p class="text-utama">Aditya W. W., S.Pd</p>
                  <p class="sub-p" style="font-size:0.6rem">NIP. 199403192023211005</p>
                  <button class="btn-guru-menu" onclick="bukaLogin()">‚öôÔ∏è Login Guru</button>
              </div>
          </div>
      </div>
    </div>
    <div style="text-align: center; margin-bottom: 25px; background: rgba(56,189,248,0.1); padding: 15px; border-radius: 15px; border: 1px solid rgba(56,189,248,0.2);">
        <p style="color:#38bdf8; font-size:0.75rem; font-weight:bold;">TUGAS AKTIF:</p>
        <h2 id="displayTopik" style="font-size: 1.2rem;">TIDAK ADA TUGAS</h2>
    </div>
    <div class="cards-grid" id="cardsGrid"></div>
  </div>

  <div id="halamanGuru">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:2px solid #eee; padding-bottom:10px;">
        <h3>üõ† Question Builder</h3>
        <button onclick="location.reload()" style="background:#64748b; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer">Keluar</button>
    </div>
    
    <label>Judul Tugas:</label>
    <input type="text" id="judulInput" placeholder="Contoh: Latihan Matematika">
    
    <label>Jenis Soal:</label>
    <select id="jenisInput" onchange="resetBuilder()">
        <option value="pg">Pilihan Ganda (Otomatis Nilai)</option>
        <option value="uraian">Uraian (Rekap Jawaban)</option>
    </select>

    <div id="containerSoal"></div>

    <button class="btn btn-add" onclick="tambahKolomSoal()">+ Tambah Soal</button>
    <button class="btn btn-primary" onclick="publikasiTugas()">PUBLIKASIKAN TUGAS</button>
    <button class="btn btn-danger" onclick="location.reload()">BATAL / KELUAR</button>
  </div>

  <div id="areaKerjaSiswa">
      <h2 id="judulTugasSiswa" style="margin-bottom:20px;"></h2>
      <div id="kontenSoalSiswa"></div>
      <button class="btn btn-primary" onclick="hitungHasil()">KIRIM JAWABAN</button>
  </div>

  <div id="sertifikat">
      <img src="logo-putih.png" style="width:50px; filter:invert(1)">
      <h2>HASIL BELAJAR</h2>
      <hr style="margin:15px 0">
      <p>Nama Siswa:</p>
      <h1 id="namaHasil" style="color:#38bdf8; margin-bottom:15px;">-</h1>
      <div id="hasilPg" style="display:none;">
          <p>Nilai Kamu:</p>
          <h1 id="nilaiAngka" style="font-size:4rem">0</h1>
      </div>
      <div id="hasilUraian" style="display:none; text-align:left; background:#f1f5f9; padding:10px; border-radius:10px;">
          <p><b>Jawaban Kamu:</b></p>
          <div id="teksJawaban"></div>
      </div>
      <br>
      <button class="btn btn-primary" onclick="downloadHasil()">üíæ SIMPAN KE GALERI (JPG)</button>
  </div>
</div>

<div class="modal-overlay" id="modalLogin">
  <div class="modal">
    <h3 style="color:white; margin-bottom:15px;">Login Guru</h3>
    <input type="password" id="passInput" placeholder="Masukkan Sandi">
    <button class="btn btn-primary" onclick="cekLogin()">Masuk</button>
    <button class="btn" style="background:transparent; color:white;" onclick="tutupLogin()">Batal</button>
  </div>
</div>

<script>
    const SISWA = ["Alvaro", "Anantha", "Arifah", "Aurelia", "Dhafitha", "Dhian", "Dimas", "Erfin", "Marsya", "Mikayla", "Ozil", "Rhevan", "Ridho", "Rizky", "Tanca"];
    let dataTugas = { judul: "", jenis: "", soal: [] };
    let siswaAktif = "";

    // Load Kartu Siswa
    const grid = document.getElementById('cardsGrid');
    SISWA.forEach(s => {
        grid.innerHTML += `<div class="student-card" onclick="bukaTugas('${s}')">
            <div class="status-badge status-belum" id="badge-${s}">Belum</div>
            <div class="student-icon">üë§</div>
            <div class="text-utama">${s}</div>
        </div>`;
    });

    // Login Logic
    function bukaLogin() { document.getElementById('modalLogin').style.display='flex'; }
    function tutupLogin() { document.getElementById('modalLogin').style.display='none'; }
    function cekLogin() {
        if(document.getElementById('passInput').value === "guru123") {
            document.getElementById('halamanDepan').style.display='none';
            document.getElementById('halamanGuru').style.display='block';
            tutupLogin();
            resetBuilder();
        } else { alert("Sandi Salah!"); }
    }

    // Question Builder Logic
    let counterSoal = 0;
    function tambahKolomSoal() {
        counterSoal++;
        const jenis = document.getElementById('jenisInput').value;
        const div = document.createElement('div');
        div.className = 'soal-card';
        div.innerHTML = `<p><b>Soal No. ${counterSoal}</b></p>
            <textarea class="q-tanya" placeholder="Tulis Pertanyaan..."></textarea>`;
        if(jenis === 'pg') {
            div.innerHTML += `
                <input type="text" class="q-a" placeholder="Opsi A">
                <input type="text" class="q-b" placeholder="Opsi B">
                <input type="text" class="q-c" placeholder="Opsi C">
                <input type="text" class="q-d" placeholder="Opsi D">
                <select class="q-kunci"><option value="0">Kunci A</option><option value="1">Kunci B</option><option value="2">Kunci C</option><option value="3">Kunci D</option></select>`;
        }
        document.getElementById('containerSoal').appendChild(div);
    }
    function resetBuilder() { document.getElementById('containerSoal').innerHTML = ""; counterSoal = 0; tambahKolomSoal(); }

    function publikasiTugas() {
        dataTugas.judul = document.getElementById('judulInput').value;
        dataTugas.jenis = document.getElementById('jenisInput').value;
        dataTugas.soal = [];
        document.querySelectorAll('.soal-card').forEach(c => {
            let s = { tanya: c.querySelector('.q-tanya').value };
            if(dataTugas.jenis==='pg') {
                s.opsi = [c.querySelector('.q-a').value, c.querySelector('.q-b').value, c.querySelector('.q-c').value, c.querySelector('.q-d').value];
                s.kunci = c.querySelector('.q-kunci').value;
            }
            dataTugas.soal.push(s);
        });
        document.getElementById('displayTopik').innerText = dataTugas.judul;
        document.getElementById('halamanGuru').style.display='none';
        document.getElementById('halamanDepan').style.display='block';
    }

    // Siswa Logic
    function bukaTugas(nama) {
        if(!dataTugas.judul) return alert("Belum ada tugas aktif.");
        siswaAktif = nama;
        document.getElementById('halamanDepan').style.display='none';
        document.getElementById('areaKerjaSiswa').style.display='block';
        document.getElementById('judulTugasSiswa').innerText = dataTugas.judul;
        let html = "";
        dataTugas.soal.forEach((s, i) => {
            html += `<div style="margin-bottom:20px; border-bottom:1px solid #eee; padding-bottom:15px;">
                <p><b>${i+1}. ${s.tanya}</b></p>`;
            if(dataTugas.jenis==='pg') {
                s.opsi.forEach((o, idx) => { html += `<label style="display:block; margin:5px 0;"><input type="radio" name="q${i}" value="${idx}"> ${o}</label>`; });
            } else { html += `<textarea class="ans-u" placeholder="Jawab di sini..."></textarea>`; }
            html += `</div>`;
        });
        document.getElementById('kontenSoalSiswa').innerHTML = html;
    }

    function hitungHasil() {
        let b = 0; let u = "";
        dataTugas.soal.forEach((s, i) => {
            if(dataTugas.jenis==='pg') {
                let sel = document.querySelector(`input[name="q${i}"]:checked`);
                if(sel && sel.value == s.kunci) b++;
            } else {
                u += `<p><b>No.${i+1}:</b> ${document.querySelectorAll('.ans-u')[i].value}</p>`;
            }
        });
        document.getElementById('areaKerjaSiswa').style.display='none';
        document.getElementById('sertifikat').style.display='block';
        document.getElementById('namaHasil').innerText = siswaAktif;
        if(dataTugas.jenis==='pg') {
            document.getElementById('hasilPg').style.display='block';
            document.getElementById('nilaiAngka').innerText = Math.round((b/dataTugas.soal.length)*100);
        } else {
            document.getElementById('hasilUraian').style.display='block';
            document.getElementById('teksJawaban').innerHTML = u;
        }
        document.getElementById(`badge-${siswaAktif}`).innerText = "Selesai";
        document.getElementById(`badge-${siswaAktif}`).className = "status-badge status-sudah";
    }

    function downloadHasil() {
        const box = document.getElementById('sertifikat');
        box.querySelector('button').style.display = 'none';
        html2canvas(box).then(canvas => {
            const link = document.createElement('a');
            link.download = `Nilai_${siswaAktif}.jpg`;
            link.href = canvas.toDataURL("image/jpeg");
            link.click();
            box.querySelector('button').style.display = 'block';
        });
    }
</script>
</body>
</html>
